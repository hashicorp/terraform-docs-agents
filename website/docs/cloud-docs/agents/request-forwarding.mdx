---
page_title: Terraform Cloud Agents - Request Forwarding
description: >-
  Access private network resources using agents with request forwarding.
---

# Request Forwarding

Terraform Cloud Agents may be configured to handle forwarding HTTP and HTTPs
requests on behalf of Terraform Cloud. This enables Terraform Cloud to access
private HTTP and HTTPS resources in restrictive external networks without
requiring direct inbound network access.

Only specific features and use cases will leverage agent request forwarding to
fulfill requests.

-> **Note:** Refer to [Terraform Cloud pricing](https://www.hashicorp.com/products/terraform/pricing) for more information about features which require request forwarding.

## Request Forwarding Architecture

Request forwarding is an additional function that must be enabled on a per-agent
basis. Agents are deployed into private networks where they have direct access
to the target private resource(s), such as private VCS systems or other APIs.
Agents register with Terraform Cloud via outbound-only connections. These
connections are held open by Terraform Cloud, and are used to transmit requests
and responses to/from the target API.

![request forwarding architecture diagram](/img/request-forwarding-arch.png)

## Routing of Forwarded Requests

Request forwarding is a function of an
[agent pool](/terraform/cloud-docs/agents/agent-pools). Each agent pool may have
multiple agents registered with request forwarding enabled. The agent pool is
then selected by the user in Terraform Cloud as the target for various features
which require access to private network resources. This creates the mapping from
Terraform Cloud resources (such as VCS connections) to a pool of agents capable
of accessing the target API.

## Agent Configuration

To enable request forwarding, start the agent with the `-request-forwarding`
flag, or set the environment variable `TFC_AGENT_REQUEST_FORWARDING=true`. When
the agent starts, you will see log messages like the following:

```
[INFO]  core: Request forwarding is enabled
[INFO]  grpc_connector: Connected to broker, awaiting requests
```

The above indicates that the agent has successfully connected to Terraform Cloud
and is ready to start forwarding requests.

## Requirements and Limitations

Agent version 1.15.0+ is required to use request forwarding.

It is recommended that at least 250mb of system memory be allocated specifically
for request forwarding. This is in addition to the minimum
[system requirements](/terraform/cloud-docs/agents/requirements).

Forwarded requests are limited to a 10mb response body. It is expected that this
limit is generous enough to comfortably support all Terraform Cloud operations
while providing protection against unbounded responses.

Agents must be able to connect to Terraform Cloud outbound over the internet, as
well as to all private request forwarding targets via HTTP/s.

## Performance and Scaling

Each agent may handle multiple requests simultaneously. In many cases, a single
agent may provide sufficient throughput to handle all forwarded requests. It is
recommended that 2 or more agents with request forwarding enabled are deployed
for each pool which will leverage request forwarding features. Running multiple
request forwarding agents provides better fault tolerance and distribution of
requests.

TODO: Say something about timeouts...

TODO: Say something about metrics and monitoring...

## Egress Proxy Support

Request forwarding agents may be deployed in scenarios where an egress proxy
is required to reach Terraform Cloud over the internet. To use an egress proxy,
first ensure the proxy software supports the
[HTTP CONNECT](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/CONNECT)
protocol. Set the `HTTPS_PROXY` environment variable when starting the agent.
The agent will use the HTTP CONNECT method to establish a secure tunnel through
the proxy to Terraform Cloud.
